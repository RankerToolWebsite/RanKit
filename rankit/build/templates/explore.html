<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Explore</title>
  <link href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
</head>
<body>
  
  <table id="example" class="display" cellspacing="0" width="100%">
    <thead>
        <tr id="head">
            <!-- <th>Name</th>
            <th>Position</th>
            <th>Office</th>
            <th>Age</th>
            <th>Start date</th>
            <th>Salary</th> -->
        </tr>
    </thead>
    <!-- <tfoot>
        <tr id="foot">
            <th>Name</th>
            <th>Position</th>
            <th>Office</th>
            <th>Age</th>
            <th>Start date</th>
            <th>Salary</th>
        </tr>
    </tfoot> -->
    <tbody id="data">
      
    </tbody>
  </table>

</body>

<script type = "text/javascript" src = "{{ url_for('static', filename = 'js/jquery-1.12.4.js') }}" ></script>
<script type = "text/javascript" src = "{{ url_for('static', filename = 'js/jquery-dataTables.min.js') }}" ></script>

<script>
  // const data = [
  //   {
  //     name: "Tiger Nixon",
  //     position: "System Architect",
  //     office: "Edinburgh",
  //     age: 61,
  //     startDate: "2011/04/25",
  //     salary: "$320,800"
  //   },

  //   {
  //     name: "Garrett Winters",
  //     position: "Accountant",
  //     office: "Tokyo",
  //     age: 63,
  //     startDate: "2011/07/25",
  //     salary: "$170,750"
  //   },

  //   {
  //     name: "Ashton Cox",
  //     position: "Junior Technical Author",
  //     office: "San Francisco",
  //     age: 66,
  //     startDate: "2009/01/12",
  //     salary: "$86,000"
  //   },
  // ]

  function renderTable(data) {
    renderHead(data[0])
    renderData(data)
    $('#example').DataTable()
  }

  function renderHead(datum) {
    const thead = Object.keys(datum)
      .map(k => `<th>${k}</th>`)
      .join('\n')
    
    document.querySelector('#head').innerHTML = thead
    // document.querySelector('#foot').innerHTML = thead
  }

  function renderData(data) {
    const html = data.map(x => {
      const props = Object.keys(x)
        .map(k => x[k])
        .map(prop => `<td>${prop}</td>`)
        .join('\n')
      return `<tr>${props}</tr>`
    })
    .join('\n')
    document.querySelector('#data').innerHTML = html
  }
  
  function parseData(raw) {
    const data = JSON.parse(raw).Prediction
    const result = Object.keys(data).map(x => ({ rank: data[x], id: x }))
    return result
  }

  const raw = '{{data|safe}}'
  const data = parseData(raw)
  renderTable(data)
  
</script>
</html>